<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Artisan Ledger</title>
    <style>
        /* --- 1. GLOBAL STYLE (Royal Theme) --- */
        :root {
            --bg-color: #121212;
            --panel-bg: #1e1e1e;
            --card-bg: #252525;
            --accent-gold: #d4af37;
            --text-main: #e0e0e0;
            --text-dim: #888;
            --danger: #ff4d4d;
            --success: #2ecc71;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 10px;
            padding-bottom: 300px; /* Spasi bawah luas untuk Panel Sticky */
        }

        h1 {
            text-align: center;
            color: var(--accent-gold);
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        /* --- 2. INPUT HARGA BAHAN (Price Ticker) --- */
        .price-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 Bahan Utama */
            gap: 5px;
            background: var(--panel-bg);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #444;
            margin-bottom: 20px;
        }

        .price-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #2a2a2a;
            border-radius: 5px;
            padding: 5px;
        }

        .price-card img { width: 35px; height: 35px; margin-bottom: 5px; }
        
        .price-input-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Input angka manual yang disamarkan jadi teks */
        .price-val-input {
            background: transparent;
            border: none;
            color: var(--accent-gold);
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            text-align: center;
            width: 100%;
            font-weight: bold;
        }
        .price-val-input:focus { outline: 1px solid var(--accent-gold); }

        .price-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 2px;
        }

        .btn-tick {
            background: #333;
            border: none;
            color: #aaa;
            font-size: 0.7rem;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 3px;
        }
        .btn-tick:hover { background: var(--accent-gold); color: #000; }

        /* --- 3. ITEM GRID (Checklist Area) --- */
        .section-header {
            color: var(--accent-gold);
            font-size: 1rem;
            margin: 20px 0 10px 0;
            padding-left: 10px;
            border-left: 3px solid var(--accent-gold);
            text-transform: uppercase;
        }

        .crafting-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        /* Kartu Item (Compact Size) */
        .item-card {
            background-color: var(--card-bg);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 6px;
            width: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.2s;
            position: relative;
        }

        /* Efek kalau item dipilih (>0) */
        .item-card.active {
            border-color: var(--accent-gold);
            background-color: #2a2510; /* Gold tint gelap */
        }

        .item-image {
            width: 45px;
            height: 45px;
            object-fit: contain;
        }

        .item-name {
            font-size: 0.65rem;
            text-align: center;
            color: #ccc;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.1;
            margin: 4px 0;
        }

        .counter-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            background: #111;
            border-radius: 15px;
            padding: 2px;
        }

        .btn-count {
            width: 22px;
            height: 22px;
            border: none;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
            color: white;
            font-size: 0.9rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .minus { background-color: var(--danger); }
        .plus { background-color: var(--success); }

        .count-display {
            font-size: 0.9rem;
            font-weight: bold;
            color: #fff;
        }

        /* --- 4. DASHBOARD HASIL (Sticky Bottom) --- */
        .dashboard-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #1a1a1a;
            border-top: 2px solid var(--accent-gold);
            box-shadow: 0 -5px 20px rgba(0,0,0,0.8);
            z-index: 100;
            display: flex;
            flex-direction: column;
            max-height: 40vh; /* Maksimal tinggi 40% layar */
        }

        /* Tab Navigasi Dashboard */
        .dash-tabs {
            display: flex;
            background: #111;
        }
        .dash-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            font-size: 0.8rem;
            color: #777;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        .dash-tab.active {
            color: var(--accent-gold);
            border-bottom-color: var(--accent-gold);
            font-weight: bold;
        }

        /* Konten Dashboard */
        .dash-content {
            padding: 15px;
            overflow-y: auto;
            flex-grow: 1;
        }
        
        .hidden { display: none; }

        /* Style untuk Tab HASIL (Grid Gambar) */
        .result-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .result-badge {
            position: relative;
            width: 50px;
            height: 50px;
            background: #333;
            border-radius: 5px;
            border: 1px solid #555;
        }
        .result-badge img { width: 100%; height: 100%; object-fit: contain; }
        .result-count {
            position: absolute;
            bottom: -5px;
            right: -5px;
            background: var(--accent-gold);
            color: #000;
            font-size: 0.7rem;
            font-weight: bold;
            padding: 2px 5px;
            border-radius: 10px;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        /* Style untuk Tab MATERIAL (List Belanja) */
        .material-list {
            display: grid;
            gap: 8px;
        }
        .mat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #252525;
            padding: 8px 12px;
            border-radius: 5px;
            border-left: 3px solid #555;
        }
        .mat-info { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; }
        .mat-info img { width: 25px; height: 25px; }
        .mat-cost { color: var(--accent-gold); font-weight: bold; font-family: 'Consolas', monospace; }
        
        .total-silver {
            text-align: right;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #444;
            color: var(--accent-gold);
            font-size: 1.1rem;
            font-weight: bold;
        }

        /* Tombol Reset */
        .reset-btn {
            position: absolute;
            top: -45px;
            right: 15px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .reset-btn:active { transform: scale(0.95); }

    </style>
</head>
<body>

    <h1>‚öúÔ∏è Royal Artisan Ledger ‚öúÔ∏è</h1>

    <div class="price-section">
        <div class="price-card">
            <img src="https://render.albiononline.com/v1/item/T5_LEATHER">
            <div class="price-input-wrapper">
                <input type="number" id="price-leather" class="price-val-input" value="0" oninput="calculateAll()">
                <div class="price-controls">
                    <button class="btn-tick" onclick="adjPrice('leather', -100)">-</button>
                    <button class="btn-tick" onclick="adjPrice('leather', 100)">+</button>
                </div>
            </div>
        </div>
        <div class="price-card">
            <img src="https://render.albiononline.com/v1/item/T5_CLOTH">
            <div class="price-input-wrapper">
                <input type="number" id="price-cloth" class="price-val-input" value="0" oninput="calculateAll()">
                <div class="price-controls">
                    <button class="btn-tick" onclick="adjPrice('cloth', -100)">-</button>
                    <button class="btn-tick" onclick="adjPrice('cloth', 100)">+</button>
                </div>
            </div>
        </div>
        <div class="price-card">
            <img src="https://render.albiononline.com/v1/item/T5_METALBAR">
            <div class="price-input-wrapper">
                <input type="number" id="price-bar" class="price-val-input" value="0" oninput="calculateAll()">
                <div class="price-controls">
                    <button class="btn-tick" onclick="adjPrice('bar', -100)">-</button>
                    <button class="btn-tick" onclick="adjPrice('bar', 100)">+</button>
                </div>
            </div>
        </div>
        <div class="price-card">
            <img src="https://render.albiononline.com/v1/item/T5_PLANKS">
            <div class="price-input-wrapper">
                <input type="number" id="price-plank" class="price-val-input" value="0" oninput="calculateAll()">
                <div class="price-controls">
                    <button class="btn-tick" onclick="adjPrice('plank', -100)">-</button>
                    <button class="btn-tick" onclick="adjPrice('plank', 100)">+</button>
                </div>
            </div>
        </div>
    </div>

    <div class="section-header">ü™ì Lumberjack</div>
    <div class="crafting-grid">
        <div class="item-card" data-name="Lumber Cap" data-img="T5_HEAD_GATHERER_WOOD" data-mat="plank" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_HEAD_GATHERER_WOOD" class="item-image">
            <div class="item-name">Cap</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Lumber Garb" data-img="T5_ARMOR_GATHERER_WOOD" data-mat="plank" data-qty="16">
            <img src="https://render.albiononline.com/v1/item/T5_ARMOR_GATHERER_WOOD" class="item-image">
            <div class="item-name">Garb</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Lumber Boots" data-img="T5_SHOES_GATHERER_WOOD" data-mat="plank" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_SHOES_GATHERER_WOOD" class="item-image">
            <div class="item-name">Boots</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
    </div>

    <div class="section-header">‚õèÔ∏è Miner</div>
    <div class="crafting-grid">
        <div class="item-card" data-name="Miner Cap" data-img="T5_HEAD_GATHERER_ORE" data-mat="bar" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_HEAD_GATHERER_ORE" class="item-image">
            <div class="item-name">Cap</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Miner Garb" data-img="T5_ARMOR_GATHERER_ORE" data-mat="bar" data-qty="16">
            <img src="https://render.albiononline.com/v1/item/T5_ARMOR_GATHERER_ORE" class="item-image">
            <div class="item-name">Garb</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Miner Boots" data-img="T5_SHOES_GATHERER_ORE" data-mat="bar" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_SHOES_GATHERER_ORE" class="item-image">
            <div class="item-name">Boots</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
    </div>

    <div class="section-header">üó°Ô∏è Skinner</div>
    <div class="crafting-grid">
        <div class="item-card" data-name="Skinner Cap" data-img="T5_HEAD_GATHERER_HIDE" data-mat="leather" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_HEAD_GATHERER_HIDE" class="item-image">
            <div class="item-name">Cap</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Skinner Garb" data-img="T5_ARMOR_GATHERER_HIDE" data-mat="leather" data-qty="16">
            <img src="https://render.albiononline.com/v1/item/T5_ARMOR_GATHERER_HIDE" class="item-image">
            <div class="item-name">Garb</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="Skinner Boots" data-img="T5_SHOES_GATHERER_HIDE" data-mat="leather" data-qty="8">
            <img src="https://render.albiononline.com/v1/item/T5_SHOES_GATHERER_HIDE" class="item-image">
            <div class="item-name">Boots</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
    </div>

    <div class="section-header">üåæ Harvester</div>
    <div class="crafting-grid">
        <div class="item-card" data-name="Harv Garb" data-img="T5_ARMOR_GATHERER_FIBER" data-mat="cloth" data-qty="16">
            <img src="https://render.albiononline.com/v1/item/T5_ARMOR_GATHERER_FIBER" class="item-image">
            <div class="item-name">Garb</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
        <div class="item-card" data-name="T5 Bag" data-img="T5_BAG" data-mat="mix_bag" data-qty="1">
            <img src="https://render.albiononline.com/v1/item/T5_BAG" class="item-image">
            <div class="item-name">Bag</div>
            <div class="counter-wrapper"><button class="btn-count minus">-</button><span class="count-display">0</span><button class="btn-count plus">+</button></div>
        </div>
    </div>


    <div class="dashboard-panel">
        <button class="reset-btn" onclick="resetCounters()">‚Üª Reset Count</button>
        
        <div class="dash-tabs">
            <div class="dash-tab active" onclick="switchTab('result')">üì¶ Hasil (Output)</div>
            <div class="dash-tab" onclick="switchTab('material')">üõí Material (Input)</div>
        </div>

        <div id="tab-result" class="dash-content">
            <div class="result-gallery" id="gallery-container">
                <div style="width:100%; text-align:center; color:#555; margin-top:20px;">
                    Belum ada item dipilih.
                </div>
            </div>
        </div>

        <div id="tab-material" class="dash-content hidden">
            <div class="material-list">
                <div class="mat-row">
                    <div class="mat-info"><img src="https://render.albiononline.com/v1/item/T5_LEATHER"> Leather</div>
                    <div class="mat-cost">x<span id="qty-leather">0</span> (<span id="cost-leather">0</span>)</div>
                </div>
                <div class="mat-row">
                    <div class="mat-info"><img src="https://render.albiononline.com/v1/item/T5_CLOTH"> Cloth</div>
                    <div class="mat-cost">x<span id="qty-cloth">0</span> (<span id="cost-cloth">0</span>)</div>
                </div>
                <div class="mat-row">
                    <div class="mat-info"><img src="https://render.albiononline.com/v1/item/T5_METALBAR"> Bar</div>
                    <div class="mat-cost">x<span id="qty-bar">0</span> (<span id="cost-bar">0</span>)</div>
                </div>
                <div class="mat-row">
                    <div class="mat-info"><img src="https://render.albiononline.com/v1/item/T5_PLANKS"> Plank</div>
                    <div class="mat-cost">x<span id="qty-plank">0</span> (<span id="cost-plank">0</span>)</div>
                </div>

                <div class="total-silver">
                    Total: <span id="grand-total">0</span> Silver
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. SETUP EVENT LISTENERS (Untuk semua tombol + dan -) ---
        document.querySelectorAll('.item-card').forEach(card => {
            const btnPlus = card.querySelector('.plus');
            const btnMinus = card.querySelector('.minus');
            const display = card.querySelector('.count-display');

            btnPlus.addEventListener('click', () => {
                let val = parseInt(display.innerText);
                display.innerText = val + 1;
                updateCardStyle(card, val + 1);
                calculateAll(); // Hitung ulang setiap klik
            });

            btnMinus.addEventListener('click', () => {
                let val = parseInt(display.innerText);
                if (val > 0) {
                    display.innerText = val - 1;
                    updateCardStyle(card, val - 1);
                    calculateAll();
                }
            });
        });

        // Ubah warna kartu kalau ada isinya
        function updateCardStyle(card, count) {
            if (count > 0) card.classList.add('active');
            else card.classList.remove('active');
        }

        // --- 2. FUNGSI UTAMA: CALCULATE ALL ---
        function calculateAll() {
            // A. Ambil Harga Bahan
            const pLeather = parseInt(document.getElementById('price-leather').value) || 0;
            const pCloth   = parseInt(document.getElementById('price-cloth').value) || 0;
            const pBar     = parseInt(document.getElementById('price-bar').value) || 0;
            const pPlank   = parseInt(document.getElementById('price-plank').value) || 0;

            // B. Siapkan Variabel Penampung
            let totalMaterials = { leather: 0, cloth: 0, bar: 0, plank: 0 };
            let galleryHTML = '';
            let hasItem = false;

            // C. Loop Semua Kartu Item
            document.querySelectorAll('.item-card').forEach(card => {
                const count = parseInt(card.querySelector('.count-display').innerText);
                
                if (count > 0) {
                    hasItem = true;
                    
                    // 1. Masukkan ke Tab Gallery (Hasil Output)
                    const imgUrl = card.dataset.img; 
                    // Trik: dataset.img cuma kode item (T5_BAG), kita perlu full URL
                    const fullImg = `https://render.albiononline.com/v1/item/${imgUrl}`;
                    
                    galleryHTML += `
                        <div class="result-badge">
                            <img src="${fullImg}">
                            <div class="result-count">${count}</div>
                        </div>
                    `;

                    // 2. Hitung Bahan (Input Material)
                    const matType = card.dataset.mat; // 'leather', 'bar', 'mix_bag', dll
                    const matQtyPerItem = parseInt(card.dataset.qty);

                    if (matType === 'leather') totalMaterials.leather += (count * matQtyPerItem);
                    else if (matType === 'cloth') totalMaterials.cloth += (count * matQtyPerItem);
                    else if (matType === 'bar') totalMaterials.bar += (count * matQtyPerItem);
                    else if (matType === 'plank') totalMaterials.plank += (count * matQtyPerItem);
                    else if (matType === 'mix_bag') {
                        // Resep Tas: 4 Leather + 4 Cloth
                        totalMaterials.leather += (count * 4);
                        totalMaterials.cloth += (count * 4);
                    }
                }
            });

            // D. Render Gallery
            const galleryContainer = document.getElementById('gallery-container');
            if (!hasItem) {
                galleryContainer.innerHTML = '<div style="width:100%; text-align:center; color:#555; margin-top:20px;">Belum ada item dipilih.</div>';
            } else {
                galleryContainer.innerHTML = galleryHTML;
            }

            // E. Render Material List & Total Cost
            // Helper format angka ribuan
            const fmt = (n) => n.toLocaleString('id-ID');

            // Update Qty Teks
            document.getElementById('qty-leather').innerText = fmt(totalMaterials.leather);
            document.getElementById('qty-cloth').innerText = fmt(totalMaterials.cloth);
            document.getElementById('qty-bar').innerText = fmt(totalMaterials.bar);
            document.getElementById('qty-plank').innerText = fmt(totalMaterials.plank);

            // Hitung Biaya per Bahan
            const cLeather = totalMaterials.leather * pLeather;
            const cCloth = totalMaterials.cloth * pCloth;
            const cBar = totalMaterials.bar * pBar;
            const cPlank = totalMaterials.plank * pPlank;

            // Update Biaya Teks
            document.getElementById('cost-leather').innerText = fmt(cLeather);
            document.getElementById('cost-cloth').innerText = fmt(cCloth);
            document.getElementById('cost-bar').innerText = fmt(cBar);
            document.getElementById('cost-plank').innerText = fmt(cPlank);

            // Grand Total
            document.getElementById('grand-total').innerText = fmt(cLeather + cCloth + cBar + cPlank);
        }

        // --- 3. HARGA ADJUSTER (+/- 100 Tombol Kecil) ---
        function adjPrice(type, amount) {
            const input = document.getElementById(`price-${type}`);
            let val = parseInt(input.value) || 0;
            val += amount;
            if (val < 0) val = 0;
            input.value = val;
            calculateAll();
        }

        // --- 4. TAB SWITCHER ---
        function switchTab(tabName) {
            // Sembunyikan semua
            document.getElementById('tab-result').classList.add('hidden');
            document.getElementById('tab-material').classList.add('hidden');
            document.querySelectorAll('.dash-tab').forEach(t => t.classList.remove('active'));

            // Munculkan yang dipilih
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
            
            // Highlight text tabnya
            // (Cara malas: loop text content, tapi biar cepat hardcode index aja)
            const tabs = document.querySelectorAll('.dash-tab');
            if (tabName === 'result') tabs[0].classList.add('active');
            else tabs[1].classList.add('active');
        }

        // --- 5. RESET FUNCTION (Fitur Spesial) ---
        function resetCounters() {
            if(!confirm("Reset semua jumlah item ke 0? (Harga bahan tidak akan berubah)")) return;

            document.querySelectorAll('.item-card').forEach(card => {
                card.querySelector('.count-display').innerText = '0';
                card.classList.remove('active');
            });
            calculateAll(); // Update dashboard jadi kosong
        }
    </script>

</body>
</html>
